{"ast":null,"code":"var _jsxFileName = \"/Users/bar-study/study-workspace/BlockchainProject/final-proj/client/src/screens/Home.js\",\n  _s = $RefreshSig$();\nimport { useEffect, useState } from 'react';\nimport Box from '@mui/material/Box';\nimport Vote from './Vote';\nimport Admin from './Admin';\nimport ElectionContract from '../contracts/Election.json';\nimport getWeb3 from '../utils/getWeb3';\nimport RoleEnum from '../utils/enums';\nimport { useNavigate } from 'react-router-dom';\nimport Header from '../components/Header.js';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function Home() {\n  _s();\n  console.log('Home called');\n  const navigate = useNavigate();\n  const [role, setRole] = useState(RoleEnum.USER);\n  const [web3, setWeb3] = useState(null);\n  const [currentAccount, setCurrentAccount] = useState(null);\n  const [contract, setContract] = useState(null);\n  const [loading, setLoading] = useState(true);\n  const loadWeb3 = async () => {\n    try {\n      console.log('loadWeb3 called');\n      const web3 = await getWeb3();\n      const accounts = await web3.eth.getAccounts();\n      const networkId = await web3.eth.net.getId();\n      const deployedNetwork = ElectionContract.networks[networkId];\n      const instance = new web3.eth.Contract(ElectionContract.abi, deployedNetwork && deployedNetwork.address);\n      setWeb3(web3);\n      setCurrentAccount(accounts[0]);\n      setContract(instance);\n      setLoading(false);\n    } catch (error) {\n      console.error('Error:', error);\n      navigate('/');\n    }\n  };\n  const getRole = async () => {\n    if (contract) {\n      const user = await contract.methods.getRole(currentAccount).call();\n      setRole(parseInt(user));\n      console.log(`role: ${role}`);\n      setLoading(false);\n    }\n  };\n  useEffect(() => {\n    loadWeb3();\n    getRole();\n  }, [contract]);\n  return /*#__PURE__*/_jsxDEV(Box, {\n    sx: {\n      bgcolor: 'background.default',\n      color: 'text.primary',\n      height: '100vh'\n    },\n    children: loading ? /*#__PURE__*/_jsxDEV(Box, {\n      sx: {\n        display: 'flex',\n        justifyContent: 'center',\n        alignItems: 'center',\n        height: '80vh'\n      },\n      children: \"Loading...\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 64,\n      columnNumber: 5\n    }, this) : /*#__PURE__*/_jsxDEV(Box, {\n      children: [/*#__PURE__*/_jsxDEV(Header, {\n        role: role\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 76,\n        columnNumber: 6\n      }, this), role === RoleEnum.ADMIN && /*#__PURE__*/_jsxDEV(Admin, {\n        role: role,\n        contract: contract,\n        web3: web3,\n        currentAccount: currentAccount\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 78,\n        columnNumber: 7\n      }, this), role === RoleEnum.USER && /*#__PURE__*/_jsxDEV(Vote, {\n        role: role,\n        contract: contract,\n        web3: web3,\n        currentAccount: currentAccount\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 7\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 75,\n      columnNumber: 5\n    }, this)\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 56,\n    columnNumber: 3\n  }, this);\n}\n_s(Home, \"U1OrV/ojscG/bSiZk5hdvdcSqik=\", false, function () {\n  return [useNavigate];\n});\n_c = Home;\nvar _c;\n$RefreshReg$(_c, \"Home\");","map":{"version":3,"names":["useEffect","useState","Box","Vote","Admin","ElectionContract","getWeb3","RoleEnum","useNavigate","Header","jsxDEV","_jsxDEV","Home","_s","console","log","navigate","role","setRole","USER","web3","setWeb3","currentAccount","setCurrentAccount","contract","setContract","loading","setLoading","loadWeb3","accounts","eth","getAccounts","networkId","net","getId","deployedNetwork","networks","instance","Contract","abi","address","error","getRole","user","methods","call","parseInt","sx","bgcolor","color","height","children","display","justifyContent","alignItems","fileName","_jsxFileName","lineNumber","columnNumber","ADMIN","_c","$RefreshReg$"],"sources":["/Users/bar-study/study-workspace/BlockchainProject/final-proj/client/src/screens/Home.js"],"sourcesContent":["import { useEffect, useState } from 'react';\nimport Box from '@mui/material/Box';\nimport Vote from './Vote';\nimport Admin from './Admin';\nimport ElectionContract from '../contracts/Election.json';\nimport getWeb3 from '../utils/getWeb3';\nimport RoleEnum from '../utils/enums';\nimport { useNavigate } from 'react-router-dom';\nimport Header from '../components/Header.js';\n\nexport default function Home() {\n\tconsole.log('Home called');\n\tconst navigate = useNavigate();\n\tconst [role, setRole] = useState(RoleEnum.USER);\n\tconst [web3, setWeb3] = useState(null);\n\tconst [currentAccount, setCurrentAccount] = useState(null);\n\tconst [contract, setContract] = useState(null);\n\tconst [loading, setLoading] = useState(true);\n\n\tconst loadWeb3 = async () => {\n\t\ttry {\n\t\t\tconsole.log('loadWeb3 called');\n\t\t\tconst web3 = await getWeb3();\n\t\t\tconst accounts = await web3.eth.getAccounts();\n\t\t\tconst networkId = await web3.eth.net.getId();\n\t\t\tconst deployedNetwork = ElectionContract.networks[networkId];\n\t\t\tconst instance = new web3.eth.Contract(\n\t\t\t\tElectionContract.abi,\n\t\t\t\tdeployedNetwork && deployedNetwork.address\n\t\t\t);\n\t\t\tsetWeb3(web3);\n\t\t\tsetCurrentAccount(accounts[0]);\n\t\t\tsetContract(instance);\n\t\t\tsetLoading(false);\n\t\t} catch (error) {\n\t\t\tconsole.error('Error:', error);\n\t\t\tnavigate('/');\n\t\t}\n\t};\n\n\tconst getRole = async () => {\n\t\tif (contract) {\n\t\t\tconst user = await contract.methods.getRole(currentAccount).call();\n\t\t\tsetRole(parseInt(user));\n\t\t\tconsole.log(`role: ${role}`);\n\t\t\tsetLoading(false);\n\t\t}\n\t};\n\n\tuseEffect(() => {\n\t\tloadWeb3();\n\t\tgetRole();\n\t}, [contract]);\n\n\treturn (\n\t\t<Box\n\t\t\tsx={{\n\t\t\t\tbgcolor: 'background.default',\n\t\t\t\tcolor: 'text.primary',\n\t\t\t\theight: '100vh',\n\t\t\t}}\n\t\t>\n\t\t\t{loading ? (\n\t\t\t\t<Box\n\t\t\t\t\tsx={{\n\t\t\t\t\t\tdisplay: 'flex',\n\t\t\t\t\t\tjustifyContent: 'center',\n\t\t\t\t\t\talignItems: 'center',\n\t\t\t\t\t\theight: '80vh',\n\t\t\t\t\t}}\n\t\t\t\t>\n\t\t\t\t\tLoading...\n\t\t\t\t</Box>\n\t\t\t) : (\n\t\t\t\t<Box>\n\t\t\t\t\t<Header role={role} />\n\t\t\t\t\t{role === RoleEnum.ADMIN && (\n\t\t\t\t\t\t<Admin\n\t\t\t\t\t\t\trole={role}\n\t\t\t\t\t\t\tcontract={contract}\n\t\t\t\t\t\t\tweb3={web3}\n\t\t\t\t\t\t\tcurrentAccount={currentAccount}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t\t{role === RoleEnum.USER && (\n\t\t\t\t\t\t<Vote\n\t\t\t\t\t\t\trole={role}\n\t\t\t\t\t\t\tcontract={contract}\n\t\t\t\t\t\t\tweb3={web3}\n\t\t\t\t\t\t\tcurrentAccount={currentAccount}\n\t\t\t\t\t\t/>\n\t\t\t\t\t)}\n\t\t\t\t</Box>\n\t\t\t)}\n\t\t</Box>\n\t);\n}\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module"}